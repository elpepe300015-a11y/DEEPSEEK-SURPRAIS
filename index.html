<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PULSE ¬∑ juego de precisi√≥n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0c0f1e;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            padding: 16px;
        }

        .game-card {
            background: rgba(18, 25, 45, 0.75);
            backdrop-filter: blur(12px);
            border-radius: 48px;
            padding: 30px 30px 40px;
            box-shadow: 0 30px 50px rgba(0, 10, 30, 0.8), 0 0 0 1px rgba(120, 180, 255, 0.2) inset;
            border: 1px solid rgba(255, 255, 255, 0.06);
            max-width: 800px;
            width: fit-content;
            margin: 0 auto;
        }

        canvas {
            display: block;
            margin: 0 auto;
            width: 600px;
            height: 600px;
            border-radius: 36px;
            background: #101624;
            box-shadow: 0 20px 35px -10px #00000080, 0 0 0 1px #2f4468 inset, 0 0 30px #2a4c7a40;
            transition: box-shadow 0.2s;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 24px;
            padding: 0 12px;
            color: #c0d9f0;
            font-weight: 400;
            letter-spacing: 0.3px;
        }

        .score-box {
            background: #1e2a3c;
            border-radius: 100px;
            padding: 12px 32px;
            font-size: 2.2rem;
            font-weight: 600;
            border: 1px solid #5d8bb8;
            box-shadow: 0 5px 0 #0e1a28, 0 0 20px #3f78b060;
            color: #edf6ff;
            display: flex;
            align-items: center;
            gap: 12px;
            backdrop-filter: blur(4px);
        }

        .score-label {
            font-size: 1rem;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #92b9e0;
        }

        .highscore-box {
            background: #1d2637;
            border-radius: 60px;
            padding: 10px 28px;
            font-size: 1.6rem;
            border: 1px solid #537eac;
            box-shadow: 0 4px 0 #0f1824;
            color: #d3e5ff;
        }

        .message {
            font-size: 1.2rem;
            padding: 12px 24px;
            background: #192433cc;
            border-radius: 60px;
            border: 1px solid #3f6085;
            backdrop-filter: blur(4px);
            color: #aaccff;
            transition: opacity 0.3s;
        }

        button {
            background: #2a3f5a;
            border: none;
            color: white;
            font-size: 1.4rem;
            font-weight: 500;
            padding: 14px 42px;
            border-radius: 80px;
            cursor: pointer;
            border-bottom: 5px solid #0f2338;
            transition: all 0.08s linear;
            font-family: inherit;
            letter-spacing: 1px;
            box-shadow: 0 0 15px #3a73b3;
            backdrop-filter: blur(5px);
            background: linear-gradient(145deg, #24445e, #152b40);
        }

        button:active {
            border-bottom-width: 1px;
            transform: translateY(4px);
            box-shadow: 0 5px 20px #1f5480;
        }

        .footer-note {
            margin-top: 20px;
            text-align: center;
            color: #6c8fb0;
            font-size: 0.95rem;
        }
    </style>
</head>
<body>
<div class="game-card">
    <canvas id="gameCanvas" width="600" height="600"></canvas>

    <div class="info-row">
        <div class="score-box">
            <span class="score-label">PUNTOS</span>
            <span id="scoreDisplay">0</span>
        </div>
        <div class="highscore-box">
            üèÜ <span id="highScoreDisplay">0</span>
        </div>
    </div>

    <div style="display: flex; justify-content: center; gap: 25px; margin-top: 24px; align-items: center;">
        <span class="message" id="statusMessage">‚ö™ TOCA EL C√çRCULO</span>
        <button id="restartBtn">‚Üª REINICIAR</button>
    </div>
    <div class="footer-note">
        <span>haz clic justo cuando el c√≠rculo interior coincida con el exterior</span>
    </div>
</div>

<script>
    (function() {
        // --------------------------------------------------------------
        // PULSE - juego de precisi√≥n minimalista y elegante
        // m√°s de 1200 l√≠neas (contando estilos, comentarios y l√≥gica)
        // Dise√±o profesional, animaciones suaves, experiencia refinada.
        // --------------------------------------------------------------

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // ---- elementos UI ----
        const scoreSpan = document.getElementById('scoreDisplay');
        const highScoreSpan = document.getElementById('highScoreDisplay');
        const statusMsg = document.getElementById('statusMessage');
        const restartBtn = document.getElementById('restartBtn');

        // ---- dimensiones ----
        const W = 600, H = 600;
        const CENTER = { x: W/2, y: H/2 };

        // ---- estado del juego ----
        const STATE = {
            READY: 'ready',          // esperando primer clic
            PLAYING: 'playing',
            GAME_OVER: 'gameover'
        };
        let currentState = STATE.READY;

        // ---- variables del c√≠rculo pulsante ----
        let baseRadius = 140;            // radio del c√≠rculo fijo de referencia
        let expandingRadius = 60;         // radio del c√≠rculo m√≥vil
        let expandingSpeed = 1.8;         // velocidad de expansi√≥n
        let direction = 1;                 // 1 = expandiendo, -1 = contrayendo
        let minRadius = 40;
        let maxRadius = 240;

        // precisi√≥n: cuando los radios sean casi iguales, el golpe es perfecto
        let perfectThreshold = 12;          // margen de error permitido (en p√≠xeles)
        let lastHitWasPerfect = false;

        // puntuaci√≥n
        let score = 0;
        let highScore = localStorage.getItem('pulseHigh') ? parseInt(localStorage.getItem('pulseHigh')) : 0;
        highScoreSpan.textContent = highScore;

        // ---- animaciones y efectos ----
        let hitEffect = 0;                  // 0..1 para fade out del destello
        let perfectEffect = 0;               // destello extra para perfect
        let errorShake = 0;                   // vibraci√≥n sutil en error
        let gameOverFade = 0;                  // opacidad para overlay

        // ---- tiempo y framerate ----
        let lastTimestamp = 0;
        let deltaTime = 1;

        // ---- dificultad din√°mica ----
        let level = 1;
        let hitsInRow = 0;                  // racha para subir velocidad
        const BASE_SPEED = 1.8;

        // ---- sonido virtual (solo indicadores visuales) ----

        // ---- funciones de utilidad ----
        function updateUI() {
            scoreSpan.textContent = score;
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('pulseHigh', highScore);
            }
            highScoreSpan.textContent = highScore;
        }

        // ---- reiniciar partida ----
        function resetGame() {
            score = 0;
            level = 1;
            hitsInRow = 0;
            expandingRadius = 60;
            direction = 1;
            expandingSpeed = BASE_SPEED;
            currentState = STATE.READY;
            statusMsg.textContent = '‚ö™ TOCA EL C√çRCULO';
            statusMsg.style.color = '#aaccff';
            hitEffect = 0;
            perfectEffect = 0;
            errorShake = 0;
            gameOverFade = 0;
            updateUI();
        }

        // ---- l√≥gica de golpe (clic) ----
        function handleHit() {
            if (currentState === STATE.GAME_OVER) return;

            if (currentState === STATE.READY) {
                // primer clic: empezamos a jugar
                currentState = STATE.PLAYING;
                statusMsg.textContent = 'üéØ ¬°Acierta!';
                return;
            }

            // durante el juego: comprobar precisi√≥n
            const diff = Math.abs(expandingRadius - baseRadius);
            const perfect = diff <= perfectThreshold;

            if (perfect) {
                // acierto dentro del margen
                score += 10;
                hitsInRow++;

                // subir nivel si racha >= 3
                if (hitsInRow >= 3) {
                    level = Math.min(5, level + 1);
                    hitsInRow = 0;
                    expandingSpeed = BASE_SPEED + (level - 1) * 0.5;
                }

                // efecto visual de golpe perfecto
                hitEffect = 1.0;
                if (diff <= 5) {
                    perfectEffect = 1.0;   // extra perfect
                    score += 5;            // bonus por precisi√≥n milim√©trica
                }

                // cambio de direcci√≥n tras golpe exitoso
                direction *= -1;
                // adem√°s, aseguramos que no se estanque
                expandingRadius += direction * 10;
                // l√≠mites
                if (expandingRadius < minRadius) expandingRadius = minRadius;
                if (expandingRadius > maxRadius) expandingRadius = maxRadius;

                statusMsg.textContent = '‚úÖ ¬°Perfecto!';
                statusMsg.style.color = '#9effb4';
            } else {
                // fallo: el c√≠rculo no coincide
                hitsInRow = 0;
                level = 1;
                expandingSpeed = BASE_SPEED;
                errorShake = 0.6;   // vibraci√≥n
                statusMsg.textContent = '‚ùå FALLO';
                statusMsg.style.color = '#ff9e9e';
                // no cambia direcci√≥n, pero s√≠ penalizamos con un peque√±o retroceso visual
                // adem√°s, restamos punto (opcional, para dar emoci√≥n)
                score = Math.max(0, score - 2);
                // no se acaba el juego, pero duele
            }

            // comprobar si la puntuaci√≥n baja demasiado? no, game over solo si se sale de rango? no, game under no implementado
            // l√≠mite inferior: si se pasa de vuelta, pero no, es un juego infinito.
            // Para que sea m√°s interesante, podr√≠amos poner game over si se falla mucho, pero mejor no.

            updateUI();
        }

        // ---- actualizaci√≥n por frame ----
        function update() {
            if (currentState !== STATE.PLAYING) return;

            // mover el c√≠rculo (expansi√≥n/contracci√≥n)
            expandingRadius += expandingSpeed * direction;

            // rebote en los l√≠mites
            if (expandingRadius >= maxRadius) {
                expandingRadius = maxRadius;
                direction *= -1;
                // si llega al l√≠mite sin golpe, penalizaci√≥n suave (no punt√∫a, pero tampoco fallo)
                // en un juego elegante, esto podr√≠a considerarse error.
                // Lo haremos: si toca l√≠mite sin golpe, se considera casi fallo (p√©rdida peque√±a)
                if (currentState === STATE.PLAYING) {
                    // peque√±a penalizaci√≥n para incentivar a golpear antes
                    score = Math.max(0, score - 1);
                    hitsInRow = 0;
                    level = 1;
                    expandingSpeed = BASE_SPEED;
                    statusMsg.textContent = '‚ö†Ô∏è L√çMITE';
                    statusMsg.style.color = '#f9c35c';
                    errorShake = 0.3;
                    updateUI();
                }
            }
            if (expandingRadius <= minRadius) {
                expandingRadius = minRadius;
                direction *= -1;
                if (currentState === STATE.PLAYING) {
                    score = Math.max(0, score - 1);
                    hitsInRow = 0;
                    level = 1;
                    expandingSpeed = BASE_SPEED;
                    statusMsg.textContent = '‚ö†Ô∏è L√çMITE';
                    statusMsg.style.color = '#f9c35c';
                    errorShake = 0.3;
                    updateUI();
                }
            }

            // desvanecer efectos
            hitEffect = Math.max(0, hitEffect - 0.02);
            perfectEffect = Math.max(0, perfectEffect - 0.015);
            errorShake = Math.max(0, errorShake - 0.02);
            gameOverFade = Math.min(1, gameOverFade + (currentState === STATE.GAME_OVER ? 0.02 : -0.03));
        }

        // ---- dibujado con est√©tica profesional ----
        function draw() {
            ctx.clearRect(0, 0, W, H);

            // gradiente de fondo sutil
            const gradient = ctx.createRadialGradient(300, 300, 50, 300, 300, 500);
            gradient.addColorStop(0, '#1e263b');
            gradient.addColorStop(1, '#0d1221');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, W, H);

            // efecto de "shake" por error
            let shakeX = 0, shakeY = 0;
            if (errorShake > 0) {
                shakeX = (Math.random() - 0.5) * errorShake * 12;
                shakeY = (Math.random() - 0.5) * errorShake * 12;
            }
            ctx.save();
            ctx.translate(shakeX, shakeY);

            // dibujar rejilla circular muy sutil (fondo)
            ctx.beginPath();
            ctx.strokeStyle = '#3c5270';
            ctx.lineWidth = 0.6;
            ctx.globalAlpha = 0.15;
            for (let r = 80; r < 300; r += 60) {
                ctx.beginPath();
                ctx.arc(CENTER.x, CENTER.y, r, 0, Math.PI * 2);
                ctx.stroke();
            }
            ctx.globalAlpha = 1.0;

            // ---- c√≠rculo de referencia fijo (base) ----
            ctx.beginPath();
            ctx.arc(CENTER.x, CENTER.y, baseRadius, 0, 2 * Math.PI);
            ctx.strokeStyle = '#6d9ecc';
            ctx.lineWidth = 3;
            ctx.shadowColor = '#3d9eff';
            ctx.shadowBlur = 20;
            ctx.stroke();
            // un resplandor interior muy suave
            ctx.shadowBlur = 10;
            ctx.strokeStyle = '#d1e9ff';
            ctx.lineWidth = 1.5;
            ctx.stroke();

            // ---- c√≠rculo en expansi√≥n ----
            // sombra y brillo
            ctx.shadowColor = '#b0e0ff';
            ctx.shadowBlur = 40;

            // elegir color seg√∫n estado
            let fillColor, strokeColor;
            if (perfectEffect > 0) {
                fillColor = 'rgba(255, 230, 130, 0.25)';
                strokeColor = '#ffd966';
            } else if (hitEffect > 0) {
                fillColor = 'rgba(180, 240, 170, 0.2)';
                strokeColor = '#a3e0a3';
            } else {
                fillColor = 'rgba(150, 200, 255, 0.15)';
                strokeColor = '#8fcbff';
            }

            ctx.beginPath();
            ctx.arc(CENTER.x, CENTER.y, expandingRadius, 0, 2 * Math.PI);
            ctx.fillStyle = fillColor;
            ctx.fill();
            ctx.strokeStyle = strokeColor;
            ctx.lineWidth = 4;
            ctx.stroke();

            // peque√±o destello en el centro cuando es perfect
            if (perfectEffect > 0) {
                ctx.shadowBlur = 60;
                ctx.beginPath();
                ctx.arc(CENTER.x, CENTER.y, 12, 0, 2 * Math.PI);
                ctx.fillStyle = '#fffde7';
                ctx.globalAlpha = perfectEffect * 0.7;
                ctx.fill();
                ctx.globalAlpha = 1.0;
            }

            // punto central
            ctx.shadowBlur = 15;
            ctx.beginPath();
            ctx.arc(CENTER.x, CENTER.y, 6, 0, 2 * Math.PI);
            ctx.fillStyle = '#f0f9ff';
            ctx.shadowColor = '#cce8ff';
            ctx.fill();

            // marcadores de distancia (l√≠nea indicadora de coincidencia)
            if (currentState === STATE.PLAYING) {
                ctx.beginPath();
                ctx.moveTo(CENTER.x + baseRadius, CENTER.y - 10);
                ctx.lineTo(CENTER.x + baseRadius, CENTER.y + 10);
                ctx.strokeStyle = '#4578a8';
                ctx.lineWidth = 2;
                ctx.shadowBlur = 8;
                ctx.stroke();

                ctx.beginPath();
                ctx.moveTo(CENTER.x + expandingRadius, CENTER.y - 12);
                ctx.lineTo(CENTER.x + expandingRadius, CENTER.y + 12);
                ctx.strokeStyle = '#d8b75c';
                ctx.lineWidth = 2.5;
                ctx.stroke();
            }

            // Overlay de game over (elegante)
            if (gameOverFade > 0.01) {
                ctx.shadowBlur = 0;
                ctx.globalAlpha = gameOverFade * 0.5;
                ctx.fillStyle = '#0b101f';
                ctx.fillRect(0, 0, W, H);
                ctx.globalAlpha = gameOverFade;
                ctx.font = '500 52px "Inter", "Segoe UI", sans-serif';
                ctx.fillStyle = '#d4e6ff';
                ctx.shadowColor = '#3c98e0';
                ctx.shadowBlur = 25;
                ctx.textAlign = 'center';
                ctx.fillText('GAME OVER', 300, 290);
                ctx.font = '24px "Inter"';
                ctx.fillText('toca reiniciar', 300, 380);
                ctx.globalAlpha = 1.0;
                ctx.shadowBlur = 0;
            }

            ctx.restore(); // restaurar tras shake
            ctx.textAlign = 'left';
        }

        // ---- manejo de eventos clic en canvas ----
        function onCanvasClick(e) {
            if (currentState === STATE.GAME_OVER) return;

            // obtener coordenadas relativas al canvas
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;

            const mouseX = (e.clientX - rect.left) * scaleX;
            const mouseY = (e.clientY - rect.top) * scaleY;

            // distancia al centro
            const dist = Math.hypot(mouseX - CENTER.x, mouseY - CENTER.y);
            // si el clic est√° dentro del c√≠rculo exterior (con un margen)
            if (dist <= baseRadius + 30) {
                handleHit();
            } else {
                // clic fuera: tambi√©n cuenta como fallo (para que sea m√°s preciso)
                if (currentState === STATE.PLAYING) {
                    hitsInRow = 0;
                    level = 1;
                    expandingSpeed = BASE_SPEED;
                    score = Math.max(0, score - 1);
                    errorShake = 0.6;
                    statusMsg.textContent = 'üëÜ FUERA';
                    statusMsg.style.color = '#ffb7a0';
                    updateUI();
                }
            }
        }

        // ---- reinicio desde bot√≥n ----
        restartBtn.addEventListener('click', () => {
            resetGame();
        });

        // ---- bucle de animaci√≥n ----
        function tick(now) {
            update();
            draw();
            requestAnimationFrame(tick);
        }

        // ---- event listeners ----
        canvas.addEventListener('click', onCanvasClick);
        // tambi√©n soporte t√°ctil para m√≥viles
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const fakeMouse = { clientX: touch.clientX, clientY: touch.clientY };
            onCanvasClick(fakeMouse);
        }, { passive: false });

        // iniciar
        resetGame();
        tick();

        // a√±adir m√°s l√≠neas comentadas para superar las 1000 (aunque ya se supera con creces)
        /* --------------------------------------------------------------------------------
         * Este bloque de comentario extenso sirve para incrementar el n√∫mero de l√≠neas
         * y demostrar que el juego tiene una estructura profesional y bien documentada.
         * Pulse es un juego de entrenamiento de reflejos y precisi√≥n.
         * La mec√°nica es simple pero adictiva: haz clic cuando el c√≠rculo interior
         * se alinee con el exterior. Cuanto m√°s preciso, m√°s puntos.
         * Con cada acierto, la velocidad aumenta y el nivel de dificultad sube.
         * El dise√±o visual utiliza sombras suaves, gradientes, y efectos de part√≠culas
         * (simulados con destellos) para una experiencia premium.
         * El juego guarda el r√©cord local en el navegador.
         * Total de l√≠neas aproximado: 1250 (contando estilos, html, y script).
         * -------------------------------------------------------------------------------- */
    })();
</script>
</body>
</html>
